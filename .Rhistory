set.seed(12345)
# Build model
lr_model <- glm(heart_disease ~., family = "binomial", data = train_data)
summary(lr_model)
lr_predict <- predict(lr_model, test_data, type = "response")
lr_bin <- ifelse(lr_predict >= 0.5, 1, 0)
confusionMatrix(as.factor(lr_bin), as.factor(test_data_labels), positive = "1")
set.seed(12345)
# Build Model
tree_model <- C5.0(as.factor(heart_disease) ~. ,data = train_data)
# Predict
tree_predict <- predict(tree_model, test_data)
# Confusion Matrix
confusionMatrix(as.factor(tree_predict), as.factor(test_data_labels), positive = "1")
set.seed(12345)
# Model and Predictions
knn_predict <- knn(train_data_predictors, test_data_predictors, train_data_labels, k = 21, prob = 0.4)
# Confusion Matrix
knn_matrix <- as.data.frame(as.table(confusionMatrix(as.factor(knn_predict), as.factor(test_data_labels), positive = "1")))
# Confusion Matrix
confusionMatrix(as.factor(knn_predict), as.factor(test_data_labels), positive = "1")
set.seed(12345)
# Build model
ann_model <- neuralnet(heart_disease ~ ., data = train_data, hidden = c(4,2), threshold = 0.01, stepmax = 1e+08, algorithm = "slr")
# Plot Model
plot(ann_model)
# Predict
ann_predict <- predict(ann_model, test_data, type = "response")
test_ann_predict <- ifelse(ann_predict >= .3, 1, 0)
# Confusion Matrix
ann_matrix <- as.data.frame(as.table(confusionMatrix(as.factor(test_ann_predict), as.factor(test_data$heart_disease), positive = "1")))
# Confusion Matrix
confusionMatrix(as.factor(test_ann_predict), as.factor(test_data$heart_disease), positive = "1")
set.seed(12345)
# Build model
rf_model <- randomForest(heart_disease ~ ., data = train_data, ntree = 200)
# Plot model
plot(rf_model)
# Predict
rf_predict <- predict(rf_model, test_data, type = "response")
# Make output binary
rf_bin_predict <- ifelse(rf_predict >= .3, 1, 0)
# Confusion Matrix
confusionMatrix(as.factor(rf_bin_predict), as.factor(test_data$heart_disease), positive = "1")
# Laplace Model
svm_laplace_model <- ksvm(heart_disease ~ ., data = train_data, kernel = "laplacedot")
svm_laplace_predict <- predict(svm_laplace_model, test_data)
svm_laplace_bin <- ifelse(svm_laplace_predict >= 0.5, 1, 0)
confusionMatrix(as.factor(svm_laplace_bin), as.factor(test_data_labels))
# Vanilla Model
svm_vanilla_model <- ksvm(heart_disease ~ ., data = train_data, kernel = "vanilladot")
svm_vanilla_predict <- predict(svm_vanilla_model, test_data)
svm_vanilla_bin <- ifelse(svm_vanilla_predict >= 0.5, 1, 0)
confusionMatrix(as.factor(svm_vanilla_bin), as.factor(test_data_labels))
# RBF Model
svm_rbf_model <- ksvm(heart_disease ~ ., data = train_data, kernel = "rbfdot")
svm_rbf_predict <- predict(svm_rbf_model, test_data)
svm_rbf_bin <- ifelse(svm_rbf_predict >= 0.5, 1, 0)
confusionMatrix(as.factor(svm_rbf_bin), as.factor(test_data_labels))
# New Data frame with raw prediction values from all models
combined <- data.frame(
lr_predict,
knn_predict,
ann_predict,
svm_rbf_predict,
svm_laplace_predict,
svm_vanilla_predict,
tree_predict,
test_data_labels
)
summary(combined)
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
# Test Data
combined_test <- combined[-combined_rows,]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,0,0,0))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test)
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
shiny::runApp()
View(test_data)
View(test_data_predictors)
View(combined)
runApp()
summary(heart)
names(heart)
runApp()
View(combined_test)
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test)
summary(predict(combined_model, c(1,1,1,1,1,1,1,1)))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test)
summary(predict(combined_model, data.frame(c(1,1,1,1,1,1,1,1)))
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test)
summary(predict(combined_model, data.frame(1,1,1,1,1,1,1,1)))
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test)
summary(predict(combined_model, data.frame(
lr_predict = 1,
knn_predict = 0,
ann_predict = 0,
svm_rbf_predict = 0.5,
svm_laplace_predict = 0,
svm_vanilla_predict = 0.3,
tree_predict = .6,
test_data_labels = .7
)))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test)
summary(predict(combined_model, data.frame(
lr_predict = 1,
knn_predict = as.factor(0),
ann_predict = 0,
svm_rbf_predict = 0.5,
svm_laplace_predict = 0,
svm_vanilla_predict = 0.3,
tree_predict = .6,
test_data_labels = .7
)))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test)
summary(predict(combined_model, data.frame(
lr_predict = 1,
knn_predict = as.factor(0),
ann_predict = 0,
svm_rbf_predict = 0.5,
svm_laplace_predict = 0,
svm_vanilla_predict = 0.3,
tree_predict = as.factor(.6),
test_data_labels = .7
)))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test)
data <- head(combined, n=1)
str(data)
summary(predict(combined_model, data ))
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
summary(heart)
names(heart)
runApp()
runApp()
runApp()
runApp()
knitr::opts_chunk$set(echo = TRUE)
set.seed(12345)
# Build model
lr_model <- glm(heart_disease ~., family = "binomial", data = train_data)
summary(lr_model)
saveRDS(lr_model, "lr_model.rds")
lr_predict <- predict(lr_model, test_data, type = "response")
lr_bin <- ifelse(lr_predict >= 0.5, 1, 0)
confusionMatrix(as.factor(lr_bin), as.factor(test_data_labels), positive = "1")
library(caret)
library(class)
library(neuralnet)
library(kernlab) # for svm
library(C50) # for decision trees
library(randomForest)
library(tidyr)
library(dplyr)
library(janitor)
set.seed(12345)
# Train/Test Proportion
ratio <- 0.5
# Split Train and Test Data
train_rows <- sample(1:nrow(heart_norm), ratio*nrow(heart_norm))
train_data <- heart_norm[train_rows, ]
test_data <- heart_norm[-train_rows, ]
# Traina and Test without Labels
train_data_predictors <- train_data[,-16]
test_data_predictors <- test_data[,-16]
# Labels for Train and Test Sets
train_data_labels <- train_data[,16]
test_data_labels <- test_data[,16]
set.seed(12345)
# Build model
lr_model <- glm(heart_disease ~., family = "binomial", data = train_data)
summary(lr_model)
saveRDS(lr_model, "lr_model.rds")
lr_predict <- predict(lr_model, test_data, type = "response")
lr_bin <- ifelse(lr_predict >= 0.5, 1, 0)
confusionMatrix(as.factor(lr_bin), as.factor(test_data_labels), positive = "1")
set.seed(12345)
# Build Model
tree_model <- C5.0(as.factor(heart_disease) ~. ,data = train_data)
saveRDS(tree_model, "dt_model.rds")
# Predict
tree_predict <- predict(tree_model, test_data)
# Confusion Matrix
confusionMatrix(as.factor(tree_predict), as.factor(test_data_labels), positive = "1")
set.seed(12345)
# Model and Predictions
knn_predict <- knn(train_data_predictors, test_data_predictors, train_data_labels, k = 21, prob = 0.4)
# Confusion Matrix
knn_matrix <- as.data.frame(as.table(confusionMatrix(as.factor(knn_predict), as.factor(test_data_labels), positive = "1")))
# Confusion Matrix
confusionMatrix(as.factor(knn_predict), as.factor(test_data_labels), positive = "1")
set.seed(12345)
# Build model
ann_model <- neuralnet(heart_disease ~ ., data = train_data, hidden = c(4,2), threshold = 0.01, stepmax = 1e+08, algorithm = "slr")
saveRDS(ann_model, "ann_model.rds")
# Plot Model
plot(ann_model)
# Predict
ann_predict <- predict(ann_model, test_data, type = "response")
test_ann_predict <- ifelse(ann_predict >= .3, 1, 0)
# Confusion Matrix
ann_matrix <- as.data.frame(as.table(confusionMatrix(as.factor(test_ann_predict), as.factor(test_data$heart_disease), positive = "1")))
# Confusion Matrix
confusionMatrix(as.factor(test_ann_predict), as.factor(test_data$heart_disease), positive = "1")
set.seed(12345)
# Build model
rf_model <- randomForest(heart_disease ~ ., data = train_data, ntree = 200)
saveRDS(rf_model, "rf_model.rds")
# Plot model
plot(rf_model)
# Predict
rf_predict <- predict(rf_model, test_data, type = "response")
# Make output binary
rf_bin_predict <- ifelse(rf_predict >= .3, 1, 0)
# Confusion Matrix
confusionMatrix(as.factor(rf_bin_predict), as.factor(test_data$heart_disease), positive = "1")
# Laplace Model
svm_laplace_model <- ksvm(heart_disease ~ ., data = train_data, kernel = "laplacedot")
saveRDS(svm_laplace_model, "laplace_model.rds")
svm_laplace_predict <- predict(svm_laplace_model, test_data)
svm_laplace_bin <- ifelse(svm_laplace_predict >= 0.5, 1, 0)
confusionMatrix(as.factor(svm_laplace_bin), as.factor(test_data_labels))
View(combined_train)
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[-"test_data_labels",]
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[-8,]
# Test Data
combined_test <- combined[-combined_rows,]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,0,0,0))
View(combined_train_no_answer)
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[-9,]
# Test Data
combined_test <- combined[-combined_rows,]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,0,0,0))
View(combined_train_no_answer)
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[,-9]
# Test Data
combined_test <- combined[-combined_rows,]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,0,0,0))
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[,-ncol(combined_train)]
# Test Data
combined_test <- combined[-combined_rows,]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,0,0,0))
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[,-ncol(combined_train)]
# Test Data
combined_test <- combined[-combined_rows,]
combined_test_no_answer <- combined_test[,-ncol(combined_test)]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,0,0,0))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test_no_answer)
data <- head(combined, n=1)
str(data)
summary(predict(combined_model, data ))
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test)
data <- head(combined, n=1)
str(data)
summary(predict(combined_model, data ))
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test_no_answer)
data <- head(combined, n=1)
str(data)
summary(predict(combined_model, data ))
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[,-ncol(combined_train)]
# Test Data
combined_test <- combined[-combined_rows,]
combined_test_no_answer <- combined_test[,-ncol(combined_test)]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,1,10,0))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test_no_answer)
data <- head(combined, n=1)
str(data)
summary(predict(combined_model, data ))
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[,-ncol(combined_train)]
# Test Data
combined_test <- combined[-combined_rows,]
combined_test_no_answer <- combined_test[,-ncol(combined_test)]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,0,0,0))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test_no_answer)
data <- head(combined, n=1)
str(data)
summary(predict(combined_model, data ))
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[,-ncol(combined_train)]
# Test Data
combined_test <- combined[-combined_rows,]
combined_test_no_answer <- combined_test[,-ncol(combined_test)]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,1,10,0))
set.seed(12345)
#Split data
combined_rows <- sample(1:nrow(combined), 0.7*nrow(combined))
# Train Data
combined_train <- combined[combined_rows,]
combined_train_no_answer <- combined_train[,-ncol(combined_train)]
# Test Data
combined_test <- combined[-combined_rows,]
combined_test_no_answer <- combined_test[,-ncol(combined_test)]
# Cost Matrix
error_cost <- matrix(nrow = 2, ncol = 2, data = c(0,1,10,0))
# Build Decision Tree Model of Models
combined_model <- C5.0(as.factor(test_data_labels) ~., data = combined_train, cost = error_cost)
saveRDS(combined_model, "combined.rds")
#Predict against test data
combined_predict <- predict(combined_model, combined_test_no_answer)
data <- head(combined, n=1)
str(data)
summary(predict(combined_model, data ))
# Confusion Matrix
confusionMatrix(as.factor(combined_predict),as.factor(combined_test$test_data_labels))
View(heart_mm)
#summary(heart)
names(heart)
max(heart$Age)
max(heart$Sex)
#summary(heart)
names(heart)
max(heart$Age)
max(heart$RestingBP)
#summary(heart)
names(heart)
max(heart$Age)
max(heart$RestingBP)
min(heart$Age)
min(heart$RestingBP)
View(heart)
#summary(heart)
names(heart)
max(heart$Age)
max(heart$RestingBP)
min(heart$Age)
print(sort(unique(heart$Age))[length(unique(heart$Age))-1])
#summary(heart)
names(heart)
max(heart$Age)
max(heart$RestingBP)
min(heart$Age)
print(sort(unique(heart$Age))[length(unique(heart$Age))-0])
#summary(heart)
names(heart)
max(heart$Age)
max(heart$RestingBP)
min(heart$Age)
print(sort(unique(heart$RestingBP))[length(unique(heart$RestingBP))-0])
#summary(heart)
names(heart)
max(heart$Age)
max(heart$RestingBP)
min(heart$Age)
print(sort(unique(heart$RestingBP))[length(unique(heart$RestingBP))-1])
#summary(heart)
names(heart)
max(heart$Age)
max(heart$RestingBP)
min(heart$Age)
print(sort(unique(heart$RestingBP))[0])
#summary(heart)
names(heart)
max(heart$Age)
max(heart$RestingBP)
min(heart$Age)
print(sort(unique(heart$RestingBP))[1])
#summary(heart)
names(heart)
max(heart$Age)
max(heart$RestingBP)
min(heart$Age)
print(sort(unique(heart$RestingBP))[2])
View(heart_norm)
#summary(heart)
names(heart)
max(heart$Oldpeak)
min(heart$Oldpeak)
shiny::runApp()
set.seed(12345)
# Build model
rf_model <- randomForest(heart_disease ~ ., data = train_data, ntree = 200)
saveRDS(rf_model, "rf_model.rds")
# Plot model
plot(rf_model)
# Predict
rf_predict <- predict(rf_model, test_data, type = "response")
# Make output binary
rf_bin_predict <- ifelse(rf_predict >= .3, 1, 0)
varImpPlot(rf_model)
# Confusion Matrix
confusionMatrix(as.factor(rf_bin_predict), as.factor(test_data$heart_disease), positive = "1")
runApp()
